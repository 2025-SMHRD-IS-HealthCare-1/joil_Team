<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>VitaMind - ì‹œë‹ˆì–´ í—¬ìŠ¤ì¼€ì–´</title>

</html>
<style>
  body, html { margin: 0; padding: 0; background-color: #F8F9FA; font-family: "Noto Sans KR", sans-serif; font-size: 33px; }
  .app { display: flex; flex-direction: column; height: 100vh; }
  header {
    background-color: #00796B; color: white;
    display: flex; justify-content: space-between; align-items: center;
    padding: 25px 35px; font-size: 45px; font-weight: 900;
  }
  .header-title { cursor: pointer; }
  .header-icons { display: flex; align-items: center; gap: 20px; }
  .mic-button { background: none; border: none; color: white; font-size: 65px; cursor: pointer; }
  .mic-button.active { color: #FF5722; }
  .logout-button {
      font-size: 30px; background: none; color: white;
      border: 3px solid white; border-radius: 15px; padding: 10px 20px;
      cursor: pointer; font-weight: bold;
  }
  main { flex: 1; overflow-y: auto; background: white; }
  .main-content { padding: 35px; }
  section { display: none; }
  section.active { display: block; }
  h2 { font-size: 47px; margin-bottom: 25px; }

  /* ë¡œê·¸ì¸ & íšŒì›ê°€ì… í™”ë©´ ìŠ¤íƒ€ì¼ */
  .auth-container { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; padding: 30px; box-sizing: border-box; }
  .auth-container h1 { font-size: 60px; color: #00796B; }
  .form-container { width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 25px; }
  .form-container input { font-size: 35px; padding: 25px; border: 3px solid #ccc; border-radius: 15px; }
  .form-container button { font-size: 37px; padding: 25px; border-radius: 15px; border: none; cursor: pointer; font-weight: bold; }
  .form-container .btn-primary { background-color: #00796B; color: white; }
  .form-container .btn-secondary { background-color: #f0f0f0; color: #333; margin-top: 15px; }
  .utility-buttons { text-align: center; margin-top: 20px; }
  .utility-buttons a { font-size: 31px; color: #555; text-decoration: underline; cursor: pointer; }

  /* í™ˆ í™”ë©´ */
  section#home.active { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; box-sizing: border-box; padding-bottom: 100px; }
  #home h2 { font-size: 80px; margin-bottom: 50px; }
  .home-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; width: 100%; }
  .home-menu button { padding: 60px 30px; font-size: 42px; border: 10px solid #00796B; border-radius: 25px; background-color: #E0F2F1; color: #004D40; cursor: pointer; }
  
  nav { display: flex; justify-content: center; align-items: center; background-color: #f0f0f0; border-top: 5px solid #ccc; padding: 20px 0; }
  .home-btn-bottom { font-size: 40px; font-weight: bold; padding: 20px 80px; border-radius: 20px; border: 5px solid #555; background-color: white; color: #333; cursor: pointer; }
  .content-pane { max-width: 1200px; margin: 0 auto; }
  
  /* ë‹¬ë ¥ ìŠ¤íƒ€ì¼ */
  .calendar-container { margin-top: 20px; }
  .calendar-header { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; font-size: 35px; font-weight: bold; padding-bottom: 15px; border-bottom: 3px solid #00796B; }
  .calendar-header div:first-child { color: red; } .calendar-header div:last-child { color: blue; }
  .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); border-left: 1px solid #ddd; }
  .calendar-day { min-height: 180px; padding: 10px; border-right: 1px solid #ddd; border-bottom: 1px solid #ddd; display: flex; flex-direction: column; }
  .calendar-day.empty { background-color: #f9f9f9; }
  .day-number { font-size: 32px; font-weight: bold; }
  .calendar-day.today .day-number { background-color: #FF5722; color: white; border-radius: 50%; width: 45px; height: 45px; display: inline-flex; justify-content: center; align-items: center; }
  .day-event { font-size: 28px; margin-top: 10px; background-color: #E0F2F1; padding: 8px; border-radius: 8px; line-height: 1.4; }

  /* (ê¸°ì¡´ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ë“¤ì€ ì—¬ê¸°ì— ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤) */
  .friend-card { display: flex; justify-content: space-between; align-items: center; border: 5px solid #BDBDBD; border-radius: 20px; padding: 30px; margin-bottom: 25px; background-color: #FAFAFA; } .friend-info { flex-grow: 1; } .friend-name { font-size: 39px; font-weight: bold; color: #004D40; } .chat-btn { font-size: 35px; padding: 20px 30px; background-color: #00796B; color: white; border: none; border-radius: 15px; flex-shrink: 0; }
  #chat-area { height: 60vh; border: 3px solid #ccc; border-radius: 15px; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; } .chat-bubble { padding: 20px; border-radius: 20px; max-width: 80%; line-height: 1.5; } .user-bubble { background-color: #DCF8C6; align-self: flex-end; } .friend-bubble { background-color: #ECECEC; align-self: flex-start; } .system-bubble { background-color: #f0f0f0; align-self: center; font-size: 28px; color: #555; } .chat-input-container { display: flex; gap: 15px; margin-top: 20px; } #chat-input { flex-grow: 1; font-size: 35px; padding: 20px; border: 3px solid #ccc; border-radius: 15px; } #chat-send-btn { font-size: 35px; padding: 0 40px; font-weight: bold; background-color: #00796B; color: white; border: none; border-radius: 15px; cursor: pointer; }
  #product-list { display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; } .product-card { display: flex; flex-direction: column; align-items: center; justify-content: space-between; border: 5px solid #BDBDBD; border-radius: 15px; padding: 20px; text-align: center; } .product-card span { font-size: 30px; margin-bottom: 15px; } .product-card button { font-size: 30px; padding: 15px 25px; background-color: #00796B; color: white; border: none; border-radius: 15px; width: 100%; } #cart { background-color: #f1f1f1; border-radius: 15px; padding: 25px; margin-top: 25px; }
  .delivery-btn { width: 100%; font-size: 45px; padding: 30px; border-radius: 20px; border: none; background-color: #FF5722; color: white; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3); margin-top: 30px; }
  #delivery .form-group { margin-bottom: 30px; } #delivery label { font-size: 35px; font-weight: bold; display: block; margin-bottom: 15px; } #delivery input, #delivery select { width: 100%; font-size: 35px; padding: 20px; border: 3px solid #ccc; border-radius: 15px; box-sizing: border-box; } .confirm-delivery-btn { width: 100%; background-color: #00796B; color: white; font-size: 45px; padding: 30px; border-radius: 20px; border: none; font-weight: bold; cursor: pointer; margin-top: 30px; }
  @media (min-width: 768px) { .main-content { padding: 50px; } .home-menu { grid-template-columns: repeat(3, 1fr); } .home-menu button { font-size: 38px; padding: 50px 30px; } #product-list { grid-template-columns: repeat(5, 1fr); } }
  #map-view { width: 100%; height: 65vh; border: 3px solid #ccc; }
  .emergency-btn { background-color: #D32F2F !important; color: white !important; border-color: #B71C1C !important; animation: pulse-red 2s infinite; }
  @keyframes pulse-red { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(211, 47, 47, 0.7); } 70% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(211, 47, 47, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(211, 47, 47, 0); } }
  .speech-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); color: white; display: flex; justify-content: center; align-items: center; font-size: 41px; text-align: center; z-index: 1000; opacity: 0; visibility: hidden; transition: 0.3s; }
  .speech-overlay.visible { opacity: 1; visibility: visible; }
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="header-title" onclick="show('schedule')">VitaMind</div>
    <div class="header-icons">
      <button class="mic-button" id="micBtn" onclick="toggleMic()">ğŸ¤</button>
      <button class="logout-button" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </header>
  
  <main>
    
    <section id="login">
        <div class="auth-container">
            <h1>VitaMind</h1>
            <div class="form-container">
                <input type="text" id="loginUserId" placeholder="ì•„ì´ë””"><input type="password" id="loginUserPw" placeholder="ë¹„ë°€ë²ˆí˜¸">
                <button class="btn-primary" onclick="handleLogin()">ë¡œê·¸ì¸</button>
                <div class="utility-buttons"><a onclick="show('signup')">íšŒì›ê°€ì…</a></div>
            </div>
        </div>
    </section>
    <section id="signup">
        <div class="auth-container">
            <h1>íšŒì›ê°€ì…</h1>
            <div class="form-container">
                <input type="text" id="signupName" placeholder="ì´ë¦„"><input type="text" id="signupDob" placeholder="ìƒë…„ì›”ì¼" onfocus="(this.type='date')"><input type="text" id="signupUserId" placeholder="ì•„ì´ë””"><input type="password" id="signupUserPw" placeholder="ë¹„ë°€ë²ˆí˜¸"><input type="tel" id="signupPhone" placeholder="ì „í™”ë²ˆí˜¸"><input type="text" id="signupAddress" placeholder="ì§‘ ì£¼ì†Œ">
                <button class="btn-primary" onclick="handleSignup()">ê°€ì…í•˜ê¸°</button>
                <button class="btn-secondary" onclick="show('login')">ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ</button>
            </div>
        </div>
    </section>
    <div class="main-content">
        <section id="home">
            <h2>ğŸ  ì–´ì„œì˜¤ì„¸ìš”! 
                VitaMindì…ë‹ˆë‹¤.!! ğŸ‘¥</h2>
            <div class="home-menu">
                <button onclick="show('friends')">ğŸ‘¥<br>ì¹œêµ¬</button><button onclick="show('market')">ğŸ›’<br>ì¥ë³´ê¸°</button><button onclick="show('map')">ğŸ—ºï¸<br>ì§€ë„</button><button onclick="show('schedule')">ğŸ“…<br>ìš°ë¦¬ë“¤ì˜ ì¼ì •</button><button onclick="show('emergency')" class="emergency-btn">ğŸš¨<br>ê¸´ê¸‰ ì—°ë½</button>
            </div>
        </section>
        <section id="friends">
            <div class="content-pane"><h2>ğŸ‘¥ ì¹œêµ¬ ëª©ë¡</h2><div id="friends-list"></div></div>
        </section>
        <section id="chat">
            <div class="content-pane">
                <h2 id="chat-with-name"></h2><div id="chat-area"></div>
                <div class="chat-input-container"><input type="text" id="chat-input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ë§ì”€í•˜ì„¸ìš”..."><button id="chat-send-btn" onclick="sendChatMessage()">ì „ì†¡</button></div>
            </div>
        </section>
        <section id="market">
             <div class="content-pane">
                <h2>ğŸ›’ ì¥ë³´ê¸°</h2><div id="product-list"></div>
                <div id="cart"><h3>ğŸ§º ì¥ë°”êµ¬ë‹ˆ (<span id="cart-count">0</span>ê°œ)</h3><ul id="cart-items"></ul></div>
                <button class="delivery-btn" onclick="requestDelivery()">ë°°ë‹¬í•˜ê¸°</button>
            </div>
        </section>
        <section id="delivery">
             <div class="content-pane">
                <h2>ğŸ›µ ë°°ë‹¬ ì„¤ì •</h2>
                <div class="form-group"><label for="delivery-address">ë°°ë‹¬ ì£¼ì†Œ</label><input type="text" id="delivery-address"></div>
                <div class="form-group"><label for="delivery-time">í¬ë§ ì‹œê°„</label><select id="delivery-time"><option>ì˜¤ëŠ˜ ì˜¤í›„ 2ì‹œ ~ 4ì‹œ</option><option>ì˜¤ëŠ˜ ì˜¤í›„ 4ì‹œ ~ 6ì‹œ</option><option>ë‚´ì¼ ì˜¤ì „ 10ì‹œ ~ 12ì‹œ</option><option>ë‚´ì¼ ì˜¤í›„ 2ì‹œ ~ 4ì‹œ</option></select></div>
                <button class="confirm-delivery-btn" onclick="confirmDelivery()">ì´ ì£¼ì†Œë¡œ ë°°ë‹¬í•˜ê¸°</button>
            </div>
        </section>
        <section id="schedule">
            <div class="content-pane">
                <h2>ğŸ“… 2025ë…„ 11ì›” ì‹œë‹ˆì–´ í´ëŸ½ ì¼ì •</h2>
                <div class="calendar-container">
                    <div class="calendar-header"><div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div></div>
                    <div id="calendar-grid" class="calendar-grid"></div>
                </div>
            </div>
        </section>
        <section id="map">
            <div class="content-pane"><h2>ğŸ—ºï¸ ë‚´ ì£¼ë³€ ì§€ë„</h2><div id="map-view"></div></div>
        </section>
        <section id="emergency">
            <div class="content-pane">
                <h2>ğŸš¨ ì‘ê¸‰ ìƒí™©</h2><p style="font-size:35px;">"ë„ì™€ì¤˜", "119" ë“±ì„ ë§ì”€í•˜ì„¸ìš”.</p>
                <button onclick="makeEmergencyCall('119')" class="emergency-btn" style="width:100%; padding: 30px; font-size: 40px; margin-top:20px;">ğŸ“ 119 ì¦‰ì‹œ ì—°ê²°</button>
                <button onclick="makeEmergencyCall('guardian')" style="width:100%; padding: 30px; font-size: 40px; margin-top:20px;">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ë³´í˜¸ìì—ê²Œ ì—°ë½</button>
            </div>
        </section>
    </div>
  </main>
  <nav>
    <button class="home-btn-bottom" onclick="show('home')">ğŸ  í™ˆìœ¼ë¡œ</button>
  </nav>
</div>
<div class="speech-overlay" id="speechOverlay"><div id="speechText">ë“£ê³  ìˆì–´ìš”...</div></div>

<script>
  // ===== ë°ì´í„° =====
  let loggedInUser = null; let friends = []; let marketProducts = []; const cart = [];
  const scheduleDataNov2025 = {
      '4': { event: 'ê´‘ì–‘, ì˜ê´‘ ì‹œë‹ˆì–´í´ëŸ½ ë‚´ë°©', details: '14:30 (6ëª…)' }, '5': { event: 'ê¹€ì œì‹œë‹ˆì–´í´ëŸ½ ë‚´ë°©', details: '10:00 (27ëª…)' }, '6': { event: 'ë‹´ë‹¹ì ì›Œí¬ìƒµ', details: 'ì·¨ì—…ì•Œì„ í˜•, ì‹œë‹ˆì–´ì¸í„´ì‰½' }, '8': { event: 'ë‹´ë‹¹ì ì›Œí¬ìƒµ', details: 'ì¥ì†Œ: ì œì£¼' }, '11': { event: 'ì¸ê³„ë©´ ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '12': { event: 'ìœ ë“±ë©´ ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '13': { event: 'íŒ”ë•ë©´ ë¬¸í™”íƒë°©', details: '9:30~, ì „ë¶ ê³ ì°½' }, '14': { event: 'ì ì„±ë©´ ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '15': { event: 'ë³µí¥ë©´ ë¬¸í™”íƒë°©', details: '9:30~ (120ëª…), ì „ë¶ ê³ ì°½' }, '16': { event: 'ìˆœì°½ë–¡ë³¶ì´í˜ìŠ¤íƒ€ ë¶€ìŠ¤', details: '9:00~, ìˆœì°½êµ° ë¯¼ì†ë§ˆì„' }, '17': { event: 'ìˆœì°½ë–¡ë³¶ì´í˜ìŠ¤íƒ€ ë¶€ìŠ¤', details: '9:00~, ìˆœì°½êµ° ë¯¼ì†ë§ˆì„' }, '18': { event: 'ê¸ˆê³¼ë©´ ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '19': { event: 'ìˆœì°½ì ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '20': { event: 'ìˆœì°½ì ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '21': { event: 'íŒ”ë•ë©´ ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '22': { event: 'ìˆœì°½ì ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }, '27': { event: 'ì„ ë„ëª¨ë¸ ë¬¸í™”íƒë°©', details: '9:00~, ì „ë¶ ê³ ì°½' }
  };

  // ===== í™”ë©´ ì „í™˜ ë° ì´ˆê¸°í™” =====
  function show(id) {
    const header = document.querySelector('header'); const nav = document.querySelector('nav'); const mainContent = document.querySelector('.main-content');
    document.querySelectorAll("main section").forEach(s => s.classList.remove("active"));
    const section = document.getElementById(id); if(section) section.classList.add("active");
    if (id === 'login' || id === 'signup') { header.style.display = 'none'; nav.style.display = 'none'; mainContent.style.display = 'none'; } else { header.style.display = 'flex'; nav.style.display = 'flex'; mainContent.style.display = 'block'; }
    if (id === 'map') loadMap();
  }
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelector('.header-title').onclick = () => show('schedule');
    const loggedInUserData = localStorage.getItem('loggedInUser');
    if (localStorage.getItem('isLoggedIn') === 'true' && loggedInUserData) {
        loggedInUser = JSON.parse(loggedInUserData); initializeMainApp(); show('home');
    } else { show('login'); }
  });
  function initializeMainApp() { renderSchedule(); generateRandomFriends(); renderFriends(); generateRandomProducts(); renderProducts(); renderCart(); }

  // ===== ë‹¬ë ¥ ìƒì„± í•¨ìˆ˜ =====
  function renderSchedule() {
      const calendarGrid = document.getElementById('calendar-grid'); calendarGrid.innerHTML = '';
      const year = 2025; const month = 10;
      const today = new Date();
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      for (let i = 0; i < firstDay; i++) { calendarGrid.innerHTML += '<div class="calendar-day empty"></div>'; }
      for (let day = 1; day <= daysInMonth; day++) {
          const dayDiv = document.createElement('div'); dayDiv.className = 'calendar-day';
          let dayNumberHTML = `<div class="day-number">${day}</div>`;
          if (day === today.getDate() && month === today.getMonth() && year === today.getFullYear()) { dayDiv.classList.add('today'); }
          if (scheduleDataNov2025[day]) {
              const item = scheduleDataNov2025[day];
              let detailsHTML = item.details ? `<span style="font-size: 26px; color: #555;"> - ${item.details}</span>` : '';
              dayNumberHTML += `<div class="day-event">${item.event}${detailsHTML}</div>`;
          }
          dayDiv.innerHTML = dayNumberHTML; calendarGrid.appendChild(dayDiv);
      }
  }
  
  // (ë¡œê·¸ì¸, íšŒì›ê°€ì…, ë¡œê·¸ì•„ì›ƒ, ì¹œêµ¬, ëŒ€í™”, ì¥ë³´ê¸°, ì§€ë„, ê¸´ê¸‰ì—°ë½, ìŒì„±ì¸ì‹ ë“± ëª¨ë“  ê¸°ì¡´ JS í•¨ìˆ˜ë“¤ì€ ì—¬ê¸°ì— ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤)
  function handleLogin() { const userId = document.getElementById('loginUserId').value; const userPw = document.getElementById('loginUserPw').value; if (!userId || !userPw) { alert('ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; } const users = JSON.parse(localStorage.getItem('vitaMindUsers')) || []; const foundUser = users.find(user => user.id === userId && user.password === userPw); if (foundUser) { localStorage.setItem('isLoggedIn', 'true'); localStorage.setItem('loggedInUser', JSON.stringify(foundUser)); loggedInUser = foundUser; alert(`${loggedInUser.name}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`); initializeMainApp(); show('home'); } else { alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'); } }
  function handleSignup() { const newUser = { name: document.getElementById('signupName').value, dob: document.getElementById('signupDob').value, id: document.getElementById('signupUserId').value, password: document.getElementById('signupUserPw').value, phone: document.getElementById('signupPhone').value, address: document.getElementById('signupAddress').value }; if (Object.values(newUser).some(v => !v)) { alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; } let users = JSON.parse(localStorage.getItem('vitaMindUsers')) || []; if (users.some(user => user.id === newUser.id)) { alert('ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤.'); return; } users.push(newUser); localStorage.setItem('vitaMindUsers', JSON.stringify(users)); alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.'); show('login'); }
  function logout() { if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) { localStorage.removeItem('isLoggedIn'); localStorage.removeItem('loggedInUser'); loggedInUser = null; if(document.getElementById('loginUserId')) document.getElementById('loginUserId').value = ''; if(document.getElementById('loginUserPw')) document.getElementById('loginUserPw').value = ''; show('login'); } }
  function renderFriends() { const list = document.getElementById("friends-list"); if(!list) return; list.innerHTML = ""; friends.forEach(f => { const div = document.createElement("div"); div.className = "friend-card"; div.innerHTML = `<div class="friend-info"><div class="friend-name">${f.name}</div><div style="font-size:33px;">ê´€ì‹¬ë¶„ì•¼: ${f.category}</div></div><button class="chat-btn" onclick="startChat('${f.name}')">ëŒ€í™”í•˜ê¸°</button>`; list.appendChild(div); }); }
  function startChat(name) { document.getElementById('chat-with-name').textContent = `${name}ë‹˜ê³¼ì˜ ëŒ€í™”`; document.getElementById('chat-area').innerHTML = ''; appendChatMessage(`${name}ë‹˜ê³¼ ëŒ€í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`, 'system'); show('chat'); }
  const chatInput = document.getElementById('chat-input'); if(chatInput) chatInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') { sendChatMessage(); } });
  function sendChatMessage() { const messageText = chatInput.value.trim(); if (messageText === '') return; appendChatMessage(messageText, 'user'); chatInput.value = ''; setTimeout(() => { const replies = ["ê·¸ë ‡êµ°ìš”!", "ë„¤, ì¢‹ì€ ìƒê°ì´ì—ìš”.", "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì°¸ ì¢‹ë„¤ìš”."]; appendChatMessage(replies[Math.floor(Math.random() * replies.length)], 'friend'); }, 1000); }
  function appendChatMessage(text, sender) { const chatArea = document.getElementById('chat-area'); if(!chatArea) return; const bubble = document.createElement('div'); bubble.className = `chat-bubble ${sender}-bubble`; bubble.textContent = text; chatArea.appendChild(í’ì„ ê»Œ); chatArea.scrollTop = chatArea.scrollHeight; }
  function requestDelivery() { if (cart.length === 0) { alert("ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤."); return; } show('delivery'); document.getElementById('delivery-address').value = loggedInUser.address; }
  function confirmDelivery() { const address = document.getElementById('delivery-address').value; const time = document.getElementById('delivery-time').value; if (!address) { alert('ë°°ë‹¬ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; } alert(`âœ… ë°°ë‹¬ ìš”ì²­ ì™„ë£Œ\n\n- ì£¼ì†Œ: ${address}\n- ì‹œê°„: ${time}\n\nì„¤ì •í•œ ì‹œê°„ëŒ€ì— ë°°ë‹¬ì´ ê°‘ë‹ˆë‹¤.`); cart.length = 0; renderCart(); show('home'); }
  function generateRandomFriends(){const lastNames=["ê¹€","ì´","ë°•","ìµœ","ì •","ê°•","ì¡°","ìœ¤","ì¥","ì„"],firstNames=["ì˜ì","ìˆœì","ì² ìˆ˜","ì˜í˜¸","ë¯¸ìˆ™","ê²½í¬","ë¯¼ì¤€","ì„œì—°","ë„ìœ¤","í•˜ì€"],interests=["ìš´ë™","ì‚°ì±…","ìš”ë¦¬","ì˜í™”","ìŒì•…","ë…ì„œ","ë“±ì‚°","ë´‰ì‚¬","ëŒ„ìŠ¤","ê½ƒ ê°€ê¾¸ê¸°"];friends=[];for(let i=0;i<10;i++)friends.push({name:lastNames[Math.floor(Math.random()*lastNames.length)]+firstNames[Math.floor(Math.random()*firstNames.length)],category:interests[Math.floor(Math.random()*interests.length)]})}
  function generateRandomProducts(){const productNames=["ë°°ì¶”","ê°ì","ì‚¬ê³¼","ë°”ë‚˜ë‚˜","ì–‘íŒŒ","ë‹¹ê·¼","ë‘ë¶€","ê³„ë€","ìš°ìœ ","ê³ ë“±ì–´","ì˜¤ì´","í˜¸ë°•","ë¼ì§€ê³ ê¸°","ì†Œê³ ê¸°","ë‹­ê³ ê¸°","ê¹€ì¹˜","ë¼ë©´","ìŒ€","ì½©ë‚˜ë¬¼","íŒŒ","ë”¸ê¸°","í† ë§ˆí† ","ë¯¸ì—­","ì°¸ê¸°ë¦„","ì„¤íƒ•","ì†Œê¸ˆ","ëœì¥","ê°„ì¥","ê³ ì¶”ì¥","ì»¤í”¼"];marketProducts=productNames.map((name,i)=>({id:i+1,name,price:Math.floor(Math.random()*9000)+1000}))}
  function renderProducts(){const list=document.getElementById("product-list"); if(!list) return; list.innerHTML="";marketProducts.forEach(p=>{const div=document.createElement("div");div.className="product-card";div.innerHTML=`<span>${p.name} - ${p.price.toLocaleString()}ì›</span><button onclick="addToCart(${p.id})">ë‹´ê¸°</button>`;list.appendChild(div)})}
  function addToCart(id){const p=marketProducts.find(x=>x.id===id);if(!p)return;cart.push(p);renderCart();alert(`${p.name}ì„(ë¥¼) ë‹´ì•˜ìŠµë‹ˆë‹¤.`)}
  function renderCart(){const cartItems=document.getElementById("cart-items"); if(!cartItems) return; cartItems.innerHTML=cart.map(c=>`<li>${c.name} (${c.price.toLocaleString()}ì›)</li>`).join('');document.getElementById("cart-count").textContent=cart.length}
  let map=null;function loadMap(){const mapContainer=document.getElementById('map-view');try{if(!map&&window.kakao&&kakao.maps){const options={center:new kakao.maps.LatLng(35.1601,126.8517),level:5};map=new kakao.maps.Map(mapContainer,options)}else if(map){map.relayout()}}catch(error){mapContainer.innerHTML="ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.";console.error("Map loading error:",error)}}
  function makeEmergencyCall(target){let number='',targetName='';if(target==='119'){number='119';targetName='119'}else if(target==='guardian'){number='010-1234-5678';targetName='ë³´í˜¸ì'}const isConfirmed=confirm(`ğŸš¨ ${targetName}ì—ê²Œ ë°”ë¡œ ì „í™”ë¥¼ ì—°ê²°í• ê¹Œìš”?\n\nì „í™” ì•±ìœ¼ë¡œ ì´ë™í•œ í›„ í†µí™” ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.`);if(isConfirmed){window.location.href=`tel:${number}`}}
  const micBtn=document.getElementById("micBtn");const overlay=document.getElementById("speechOverlay");const speechText=document.getElementById("speechText");let recognition;if("webkitSpeechRecognition"in window){recognition=new webkitSpeechRecognition();recognition.lang="ko-KR";recognition.onstart=()=>{micBtn.classList.add("active");overlay.classList.add("visible");speechText.textContent="ë“£ê³  ìˆì–´ìš”..."};recognition.onend=()=>{micBtn.classList.remove("active");setTimeout(()=>overlay.classList.remove("visible"),1000)};recognition.onresult=e=>{const text=e.results[0][0].transcript.trim();speechText.textContent=`"${text}"`;handleVoiceCommand(text)}}
  function toggleMic(){if(recognition)recognition.start()}
  function handleVoiceCommand(text) { text = text.toLowerCase(); const isChatActive = document.getElementById('chat').classList.contains('active'); const isDeliveryActive = document.getElementById('delivery').classList.contains('active'); if (text.includes("ë„ì™€ì¤˜") || text.includes("119")) { makeEmergencyCall('119'); return; } if (text.includes("ë³´í˜¸ì")) { makeEmergencyCall('guardian'); return; } if (isChatActive && !["í™ˆ","ì¹œêµ¬","ì‹œì¥","ì§€ë„","ê¸´ê¸‰","ë°°ë‹¬", "ì¼ì •"].some(cmd => text.includes(cmd))) { appendChatMessage(text, 'user'); setTimeout(() => { appendChatMessage("ìŒì„±ìœ¼ë¡œ ë§ì”€í•˜ì…¨ë„¤ìš”! ì˜ ë“¤ë ¤ìš”.", 'friend'); }, 1000); return; } if (isDeliveryActive && (text.includes("ë°°ë‹¬ í™•ì¸") || text.includes("ê²°ì •") || text.includes("ì´ ì£¼ì†Œë¡œ"))) { confirmDelivery(); return; } if (text.includes("í™ˆ")) show("home"); else if (text.includes("ì¹œêµ¬")) show("friends"); else if (text.includes("ì‹œì¥") || text.includes("ì¥ë³´ê¸°")) show("market"); else if (text.includes("ì§€ë„")) show("map"); else if (text.includes("ì¼ì •") || text.includes("ìŠ¤ì¼€ì¤„")) show("schedule"); else if (text.includes("ê¸´ê¸‰")) show("emergency"); else if (text.includes("ë°°ë‹¬")) requestDelivery(); else if (text.includes("ë¡œê·¸ì•„ì›ƒ")) logout(); else { const friend = friends.find(f => text.includes(f.name.toLowerCase())); if (friend && text.includes("ëŒ€í™”")) { startChat(friend.name); return; } const product = marketProducts.find(p => text.includes(p.name)); if (product && text.includes("ë‹´ì•„")) { show('market'); addToCart(product.id); return; } speechText.textContent = "ëª…ë ¹ì„ ì´í•´í•˜ì§€ ëª»í–ˆì–´ìš”."; } }
</script>
<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=433a059560072e066820d8b58d1e68f7"></script>


</body>
</html>